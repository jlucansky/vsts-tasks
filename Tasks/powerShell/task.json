{
    "id": "E213FF0F-5D5C-4791-802D-52EA3E7BE1F1",
    "name": "PowerShell",
    "friendlyName": "PowerShell",
    "description": "Run a PowerShell script",
    "helpMarkDown": "[More Information](https://go.microsoft.com/fwlink/?LinkID=613736)",
    "category": "Utility",
    "visibility": [
        "Build",
        "Release"
    ],
    "runsOn": [
        "Agent",
        "DeploymentGroup"
    ],
    "author": "Microsoft Corporation",
    "version": {
        "Major": 2,
        "Minor": 120,
        "Patch": 0
    },
    "preview": true,
    "minimumAgentVersion": "2.120.0",
    "groups": [
        {
            "name": "advanced",
            "displayName": "Advanced",
            "isExpanded": false
        }
    ],
    "inputs": [
        {
            "name": "script",
            "type": "multiLine",
            "label": "Inline Script",
            "required": true,
            "defaultValue": "# You can write your powershell scripts inline here. \n# You can also pass predefined and custom variables to this scripts using arguments\n\n Write-Host \"Hello World\"",
            "properties": {
                "resizable": "true",
                "rows": "10",
                "maxLength": "500"
            },
            "helpMarkDown": ""
        },
        {
            "name": "errorActionPreference",
            "type": "pickList",
            "label": "ErrorActionPreference",
            "required": false,
            "defaultValue": "stop",
            "options": {
                "stop": "Stop",
                "continueOnError": "ContinueOnError",
                "silentlyContinue": "SilentlyContinue"
            },
            "helpMarkDown": ""
        },
        {
            "name": "failOnStderr",
            "type": "boolean",
            "label": "Fail on Standard Error",
            "required": false,
            "defaultValue": "false",
            "helpMarkDown": "If this is true, this task will fail if any errors are written to the error pipeline, or if any data is written to the Standard Error stream. Otherwise the task will rely on $LASTEXITCODE and the exit code to determine failure."
        },
        {
            "name": "ignoreExitCode",
            "type": "boolean",
            "label": "Ignore Exit Code",
            "required": false,
            "defaultValue": "false",
            "helpMarkDown": ""
        },
        {
            "name": "ignoreLASTEXITCODE",
            "type": "boolean",
            "label": "Ignore $LASTEXITCODE",
            "required": false,
            "defaultValue": "false",
            "helpMarkDown": ""
        },
        {
            "name": "workingDirectory",
            "type": "filePath",
            "label": "Working Directory",
            "required": false,
            "defaultValue": "",
            "helpMarkDown": "Working directory where the script is run."
        }
    ],
    "instanceNameFormat": "PowerShell Script",
    "execution": {
        "Script": {
            "target": "powershell",
            "script": "$(script)",
            "errorActionPreference": "$(errorActionPreference)",
            "failOnStderr": "$(failOnStderr)",
            "ignoreExitCode": "$(ignoreExitCode)",
            "ignoreLASTEXITCODE": "$(ignoreLASTEXITCODE)",
            "workingDirectory": "$(workingDirectory)"
        }
    }
}